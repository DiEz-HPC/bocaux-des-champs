{% extends 'partials/_master.twig' %}

{% from '@theme/macros/images.twig' import imagePosition %}

{% setcontent products = 'Produits' latest limit 3 %}
{% setcontent engagements = 'Engagements' latest limit 1 %}
{% setcontent history = 'Histoire' latest limit 1 %}
{% set pictures = [] %}

{% if engagements.pictures is defined %}
    {% for picture in engagements.pictures %}
        {% set pictures = pictures|merge([picture]) %}
    {% endfor %}
{% endif %}
{% if history.pictures is defined %}
    {% for picture in history.pictures %}
        {% set pictures = pictures|merge([picture]) %}
    {% endfor %}
{% endif %}

{% block stylesheet %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/pictures.css') }}">
    <link rel="stylesheet" href="{{ asset('css/homepage.css') }}">
{% endblock %}

{% block main %}
    <div class="homepage mb-5 pb-5">
        <div class="firstview vh-100 d-flex flex-column align-items-center justify-content-center">
            <img class="firstImage" src="{{ thumbnail(homepage.image, 200, 200) }}" alt="{{ homepage.logo.alt }}">
            <h1 class="text-center">{{ homepage.title | upper }}</h1>
        </div>
        <div class="secondview min-vh-100 d-flex flex-column align-items-center justify-content-between flex-lg-row py-5 px-3 px-xl-5">
            <div class="block-left col-lg-6 d-flex flex-column align-items-center justify-content-center">
                <div class="engagements col-12">
                    <h2>{{ 'Nos engagements' | upper }}</h2>
                    <p>{{ engagements.firstParagraph | excerpt(800) }}</p>
                    <p>{{ engagements.secondParagraph | excerpt(200) }}</p>
                    <a class="btn btn-separate text-light my-3" href="{{ history|link }}" role="button">Link</a>
                </div>

                {# only mobile #}
                <div class="mobile col-lg-6 d-flex d-lg-none flex-column align-items-between justify-content-center position-relative mb-5">
                    {% if engagements.pictures is defined %}
                        {% for picture in engagements.pictures|shuffle %}
                            {% if loop.index <= 3 %}
                                {{ imagePosition(loop.index, picture) }}
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </div>

                <div class="history">
                    <h2>{{ 'Notre histoire' | upper }}</h2>
                    {{ history.introduction | excerpt(2000) }}
                    <div class="separate-block col-6 my-3"></div>
                </div>
            </div>

            {# only mobile #}
            <div class="mobile col-lg-6 d-flex d-lg-none flex-column align-items-between justify-content-center position-relative mb-5">
                {% if history.pictures is defined %}
                    {% for picture in history.pictures|shuffle %}
                        {% if loop.index <= 3 %}
                            {{ imagePosition(loop.index, picture) }}
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>

            {# only desktop #}
            <div class="block-right col-lg-5 d-none d-lg-flex flex-column align-items-center justify-content-lg-center justify-content-between position-relative">
                {% if pictures %}
                    {% for picture in pictures|shuffle %}
                        {% if loop.index <= 3 %}
                            {{ imagePosition(loop.index, picture) }}
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
        </div>
        <div class="thirdview px-3 px-xl-5">
            <h2 class="text-center fw-bold mb-5">{{ 'Nos Produits' | upper }}</h2>
            <div class="card-container d-flex flex-column flex-sm-row justify-content-sm-around">
                {% for product in products %}
                    <div class="card col-sm-3 mb-3">
                        <img src="{{ thumbnail(product.image, 350, 350) }}" alt="{{ product.image.alt }}">
                        <div class="card-body">
                            <h5 class="card-title">{{ product.title }}</h5>
                            <p class="card-text">{{ product.teaser }}</p>
                            <a href="{{ product|link }}" class="btn btn-primary">{{ 'Voir le produit' | upper }}</a>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="d-flex justify-content-center align-items-center">
                <div class="separate-block col-6 my-5"></div>
            </div>
        </div>
    </div>
{% endblock main %}

